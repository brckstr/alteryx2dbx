{% extends "AlteryxNode.txt" %}

{% if file_type == "oracle" %}
{% block body %}
{{ output_name }} = (
  spark.read.format("jdbc")
  .option("url", "jdbc:oracle:thin:@//{{ file_opts.jdbc_url }}")
  .option("user", {{ file_opts.username }})
  .option("password", dbutils.secrets.get("<secret_store>","oracle_password"))
  .option("driver", "oracle.jdbc.driver.OracleDriver")
  .option("query","""
  {{ file_opts.query }}
  """)
  .load()
)

display({{ output_name }})
{% endblock %}
{% endif %}